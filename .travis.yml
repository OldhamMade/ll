dist: trusty
sudo: false 

language: c

cache:
  directories:
    - $HOME/.asdf/

before_install:
before_install: 
  - "sudo apt-get update"
  - set +e
  - git clone https://github.com/asdf-vm/asdf.git $HOME/.asdf --branch v0.4.3
  - "echo -e '\\n. $HOME/.asdf/asdf.sh' >> $HOME/.bashrc"
  - "echo -e '\\n. $HOME/.asdf/completions/asdf.bash' >> $HOME/.bashrc"
  - set -e
  - source $HOME/.bashrc
  - set +e
  - asdf plugin-add nim https://github.com/rfrancis/asdf-nim
  - asdf install nim v0.18.0
  - set -e
  - asdf global nim v0.18.0
  - export NIM_LIB_PREFIX=$HOME/.asdf/installs/nim/v0.18.0

jobs:
  include:
    - stage: run tests
      script: >
        nimble build -y && nimble test -y
